<?xml version="1.0" encoding="utf-8"?>
<window:EfficientTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
                             xmlns:s="library://ns.adobe.com/flex/spark"
                             xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:uicontrol="uicontrol.*"
                             xmlns:conobj="uicontrol.conobj.*"
                             width="450" height="250" creationComplete="init()"
                             title="创建项目" xmlns:window="control.window.*">
	<fx:Script>
		<![CDATA[
        import httpcontrol.HttpServiceUtil;

        import mx.controls.Alert;
        import mx.core.FlexGlobals;
        import mx.managers.PopUpManager;
        import mx.rpc.events.ResultEvent;

        import util.DateUtil;

        import util.ToolUtil;

        private function init():void {

        }


        private function getOrgByFlagResult(result:Object, e:ResultEvent):void {
            this.title = result.result.name + " 新成员注册";
        }

        public function save():void {
            if (orgname.text == "") {
                Alert.show("组织名称必须填写", "提示");
                return;
            }

            var obj:Object = new Object();

            obj.name = orgname.text;

            obj.icon = orgHeadSelectArray.selectedIcon();


            HttpServiceUtil.getCHTTPServiceAndResult("/riliusers/regOrganization", refresh, "POST").send(obj);


        }

        public function refresh(r:Object, e:ResultEvent):void {
            closeWin();
            ToolUtil.sessionUserRefresh(ToolUtil.currentUserFun);
            if (ToolUtil.selectOrg != null && ToolUtil.selectOrg.parent != null) {
                PopUpManager.removePopUp(ToolUtil.selectOrg);
                ToolUtil.selectOrg = new SelectOrgPanel();
            }
        }

        public function foucePass(obj:Object):void {
            obj.setFocus();
        }
        ]]>
	</fx:Script>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
        <conobj:HeadSelectArray id="orgHeadSelectArray"></conobj:HeadSelectArray>
	</fx:Declarations>


	<s:Form width="100%" id="form" >


		<s:FormItem  label="项目名称:" textAlign="right">
			<s:layout>
				<s:HorizontalLayout gap="5"/>
			</s:layout>
			<s:TextInput id="projectname"  width="200"  tabIndex="5" >
				
			</s:TextInput>
		</s:FormItem>
        <s:FormItem  label="项目描述:" textAlign="right">
            <s:TextArea width="200" height="60"></s:TextArea>
        </s:FormItem>
        <s:FormItem  label="父级项目:" textAlign="right">
            <s:DropDownList id="fatherDownList" labelField="label" selectedIndex="0" dataProvider="{ToolUtil.projectList}"  ></s:DropDownList>
        </s:FormItem>
        <s:FormItem  label="隶属部门:" textAlign="right">
            <s:DropDownList id="departmentDownList" labelField="label" selectedIndex="0" dataProvider="{ToolUtil.myDepartmentList}"  ></s:DropDownList>
        </s:FormItem>
        <s:FormItem  label="负责人:" textAlign="right">
            <s:DropDownList id="managerDownList" labelField="label" selectedIndex="0" dataProvider="{ToolUtil.myDepartmentList}"  ></s:DropDownList>
        </s:FormItem>
        <s:FormItem  label="开始日期:" textAlign="right">
            <mx:DateField id="startDate" width="100"  formatString="YYYY-MM-DD" dayNames="{DateUtil.dayNames}" monthNames="{DateUtil.monthNames}" />
        </s:FormItem>
        <s:FormItem  label="结束日期:" textAlign="right">
            <mx:DateField id="endDate" width="100"  formatString="YYYY-MM-DD" dayNames="{DateUtil.dayNames}" monthNames="{DateUtil.monthNames}" />
        </s:FormItem>
        <s:FormItem  label="项目状态:" textAlign="right">
            <s:DropDownList id="statusDownList" labelField="label" selectedIndex="0" dataProvider="{ToolUtil.myDepartmentList}"  ></s:DropDownList>
        </s:FormItem>

		<s:FormItem>
				<s:layout>
					<s:HorizontalLayout gap="10"/>
				</s:layout>
				<s:Button label="保存" click="save()" chromeColor="red" color="#ffffff" height="25"  tabIndex="10">
					
				</s:Button>
				<s:Button label="放弃" click="closeWin()" chromeColor="#ffffff" color="#000000" height="25">
					
				</s:Button>
		</s:FormItem>
	</s:Form>
</window:EfficientTitleWindow>
