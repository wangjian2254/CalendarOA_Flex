<?xml version="1.0"?>
<!--
  Created by wangjian2254 on 14-8-8.
-->
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
                xmlns:mx="library://ns.adobe.com/flex/mx"
                autoDrawBackground="true"
        >
    <fx:Metadata>
        [Event(name="listItemClick",type="events.ListClickEvent")]
        [Event(name="listItemZhanKai",type="events.ListClickEvent")]
    </fx:Metadata>
    <fx:Script><![CDATA[
        import events.ListClickEvent;

        import util.ToolUtil;



        private var _data:Object;
        override public function get data():Object {
            return _data;
        }

        override public function set data(value:Object):void {
            _data = value;
            super.data = value;
            if(value==null){
                return;
            }
            if(!data.predate||(data.predate.substr(0,16)!=data.d.substr(0,16))){
                dateGroup.height=30;
                dateGroup.visible=true;
            }else{
                dateGroup.height=0;
                dateGroup.visible=false;
            }
            var person:Object = ToolUtil.getPersonById(data.f);
            if(person.id==ToolUtil.sessionUser.pid){
                head2.source = person.icon;
                nameLabel2.text = person.name;
                head.source = null;
                nameLabel.text = "";
                horizontalLayout.horizontalAlign="right";
                chatstatus.horizontalAlign="right";
//                heaGroup.horizontalAlign = "right";
            }else{
                 head.source = person.icon;
                head2.source = null;
                nameLabel.text = person.name;
                nameLabel2.text = "";
                horizontalLayout.horizontalAlign="left";
                chatstatus.horizontalAlign="left";
//                heaGroup.horizontalAlign="left";
            }
            contentLabel.text = data.te;
            contentLabel.setStyle("fontFamily","simsun,MINGLIU");
            contentLabel.setStyle("alignmentBaseline","ideographicCenter");
            contentLabel.setStyle("color",data.co);
            contentLabel.setStyle("fontWeight",data.we);
            contentLabel.setStyle("fontStyle",data.st);
            contentLabel.setStyle("textDecoration",data.de);
            contentLabel.setStyle("fontSize",data.si);
            dateLabel.text = data.d;

            if(data.hasOwnProperty("status")){
//                statusLabel.text = data.status;
            }else{
                statusLabel.text = null;

            }
            contentLabel.validateNow();


        }

        private function select_handler(e:MouseEvent):void{
            var listclickevent:ListClickEvent=new ListClickEvent("listItemClick",data);
            dispatchEvent(listclickevent);

        }

        protected function m_over():void{
            chatstatus.visible = true;
            solidColor.color = 0x7ae7bf;
        }

        protected function m_out():void{
            chatstatus.visible = false;
            solidColor.color = 0xffffff;
        }
        ]]></fx:Script>

    <s:BorderContainer id="borderContainer" width="100%" minHeight="15" click="select_handler(event)" borderVisible="false" mouseOut="m_out()" mouseOver="m_over()">


        <s:Rect id="backgroundRect" left="0" right="0" top="0" bottom="0">
            <s:fill>
                <s:SolidColor color="0xdbdbdb" />
            </s:fill>
        </s:Rect>
        <s:Rect left="1" right="1" top="0" bottom="1">
            <s:fill>
                <s:SolidColor id="solidColor" color="0xffffff"  />
            </s:fill>
        </s:Rect>
        <s:VGroup width="100%">
        <s:HGroup id="dateGroup" width="100%" height="20" horizontalAlign="center" verticalAlign="middle" >
            <s:Label id="dateLabel" color="#000000"></s:Label>
        </s:HGroup>
        <s:HGroup  verticalAlign="top" horizontalAlign="center" width="100%" gap="0" paddingRight="5" paddingLeft="5">
            <s:VGroup paddingTop="5" horizontalAlign="center" gap="2">
                <s:Image id="head" width="25" height="25"></s:Image>
                <s:Label id="nameLabel"  color="#000000"></s:Label>
            </s:VGroup>
            <s:VGroup id="horizontalLayout" verticalAlign="top" width="100%" paddingRight="5" paddingLeft="5">

                <s:Label id="contentLabel" maxDisplayedLines="-1" maxWidth="{borderContainer.width*0.8}" paddingTop="10" paddingLeft="10" paddingRight="10"  ></s:Label>
                <s:HGroup id="chatstatus" verticalAlign="top" width="100%" paddingRight="10" paddingLeft="10" visible="false">
                    <s:Label id="statusLabel" color="#000000"></s:Label>
                    <mx:LinkButton id="myFZRButton" label="我负责" textDecoration="underline" ></mx:LinkButton>
                    <mx:LinkButton id="selectFZRButton" label="指派"  textDecoration="underline" ></mx:LinkButton>
                </s:HGroup>
            </s:VGroup>
            <s:VGroup paddingTop="5"  horizontalAlign="center" gap="2">
                <s:Image id="head2" width="25" height="25"></s:Image>
                <s:Label id="nameLabel2"  color="#000000"></s:Label>
            </s:VGroup>

        </s:HGroup>
        </s:VGroup>
    </s:BorderContainer>
</s:ItemRenderer>
